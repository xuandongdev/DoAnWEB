<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Giỏ Hàng</title>
    <link rel="shortcut icon" href="./img/Header-Footer/iconFinal.png" type="image/x-icon" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="style.css" />
    <script>
        window.onload = function() {
            showCart();
        };
    </script>
    <script src="cart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.min.js" integrity="sha512-ykZ1QQr0Jy/4ZkvKuqWn4iF3lqPZyij9iRv6sGqLRdTPkY69YX6+7wvVGmsdBbiIfN/8OdsI7HABjvEok6ZopQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <header id="search">
        <!-- Container đầy đủ chiều rộng, đặt background-image -->
        <div class="container-fluid con-nav">
            <!-- Dòng chia thành 1 cột -->
            <div class="row row-cols-1">
                <!-- Chiếm 3 cột trên màn hình lớn, 1 cột trên màn hình nhỏ -->
                <div class="col-lg-3 col-1">
                    <!-- Logo chuyển đổi thành button -->
                    <a class="btn" href="index.html"><img src="./img/Header-Footer/logoFinal.png" height="100px" /></a>
                </div>
            </div>
        </div>

        <!-- Thanh navbar và chuyển đổi ngôn ngữ -->
        <div class="container-fluid">
            <!-- Navbar sử dụng Bootstrap -->
            <div class="navbar navbar-expand-lg text-white navbar-translation">

                <!-- Dropdown chọn ngôn ngữ -->
                <div class="select-wrapper">
                    <div class="navbar-nav ms-auto">
                        <!-- Dropdown ngôn ngữ -->
                        <select class="form-select bg-danger text-white" onchange="changeLanguage(this.value)">
                        <!-- Các tùy chọn ngôn ngữ -->
                        <option value="vi">VI</option> <!-- Tiếng Việt -->
                        <option value="en">EN</option> <!-- Tiếng Anh -->
                    </select>
                    </div>
                </div>

                <!-- Toggle button cho responsive design -->
                <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#collapse">
                <span class="navbar-toggler-icon"></span>
            </button>

                <!-- Các mục navbar -->
                <div class="collapse navbar-collapse" id="collapse">
                    <div class="navbar-nav">
                        <!-- Danh sách mục điều hướng -->
                        <ul class="navbar-nav">
                            <!-- Mục Trang Chủ -->
                            <li class="nav-item">
                                <!-- Dùng bootstrap class="nav-link" định dạng giao diện cho thẻ link  -->
                                <a href="index.html" class="nav-link lang-vi">
                                    <i class="fa-solid fa-house"></i> Trang Chủ
                                    <!-- Tiếng Việt -->
                                </a>
                                <a href="index.html" class="nav-link lang-en" style="display: none;">
                                    <i class="fa-solid fa-house"></i> Home
                                    <!-- Tiếng Anh (ẩn) -->
                                </a>
                            </li>
                            <!-- Mục Sản Phẩm -->
                            <li class="nav-item">
                                <!-- Dùng bootstrap class="nav-link" định dạng giao diện cho thẻ link  -->
                                <a href="product.html" class="nav-link lang-vi">
                                    <i class="fa-brands fa-product-hunt"></i> Sản Phẩm
                                    <!-- Tiếng Việt -->
                                </a>
                                <a href="product.html" class="nav-link lang-en" style="display: none;">
                                    <i class="fa-brands fa-product-hunt"></i> Products
                                    <!-- Tiếng Anh (ẩn) -->
                                </a>
                            </li>
                            <!-- Mục Giỏ Hàng -->
                            <li class="nav-item">
                                <!-- Dùng bootstrap class="nav-link" định dạng giao diện cho thẻ link  -->
                                <a href="cart.html" class="nav-link lang-vi">
                                    <i class="fa-solid fa-cart-shopping"></i> Giỏ Hàng
                                    <!-- Tiếng Việt -->
                                </a>
                                <a href="cart.html" class="nav-link lang-en" style="display: none;">
                                    <i class="fa-solid fa-cart-shopping"></i> Cart
                                    <!-- Tiếng Anh (ẩn) -->
                                </a>
                            </li>
                            <!-- Mục Đăng Nhập -->
                            <li class="nav-item">
                                <!-- Dùng bootstrap class="nav-link" định dạng giao diện cho thẻ link  -->
                                <a href="log_In.html" class="nav-link lang-vi">
                                    <i class="fa-solid fa-user"></i> Đăng Nhập
                                    <!-- Tiếng Việt -->
                                </a>
                                <a href="log_In.html" class="nav-link lang-en" style="display: none;">
                                    <i class="fa-solid fa-user"></i> Log In
                                    <!-- Tiếng Anh (ẩn) -->
                                </a>
                            </li>
                            <!-- Mục Đăng Ký -->
                            <li class="nav-item">
                                <!-- Dùng bootstrap class="nav-link" định dạng giao diện cho thẻ link  -->
                                <a href="sign_Up.html" class="nav-link lang-vi">
                                    <i class="fa-regular fa-user"></i> Đăng Ký
                                    <!-- Tiếng Việt -->
                                </a>
                                <a href="sign_Up.html" class="nav-link lang-en" style="display: none;">
                                    <i class="fa-regular fa-user"></i> Sign Up
                                    <!-- Tiếng Anh (ẩn) -->
                                </a>
                            </li>
                            <!-- Mục Giới Thiệu -->
                            <li class="nav-item">
                                <!-- Dùng bootstrap class="nav-link" định dạng giao diện cho thẻ link  -->
                                <a href="about_Us.html" class="nav-link lang-vi">
                                    <i class="fa-regular fa-user"></i> Giới Thiệu
                                    <!-- Tiếng Việt -->
                                </a>
                                <a href="about_Us.html" class="nav-link lang-en" style="display: none;">
                                    <i class="fa-regular fa-user"></i> About Us
                                    <!-- Tiếng Anh (ẩn) -->
                                </a>
                            </li>
                            <!-- Các mục khác -->
                            <!-- Thêm các mục khác tại đây -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Dùng bootstrap class="container-lg mx-15 border border-white" -->
    <main class="container-lg mx-lg-15 border border-white">
        <!-- Phần chính của trang  -->
        <article class="main-content">
            <!-- Phần tiếng Việt và tiếng Anh (ẩn) nằm xen kẻ nhau -->
            <h1 class="lang-vi" id="cart">Chi Tiết Đơn Hàng</h1>
            <h1 class="lang-en" id="cart" style="display:none;">Order Details</h1>
            <!-- Dùng bootstrap class="table table-hover" áp dụng mặc định bảng và hiệu ứng di chuột qua  -->
            <table id="cartDetail" class="container-fluid table table-hover cart-table">
                <!-- Phần tiêu đề cho biết cột có chức năng gì  -->
                <thead>
                    <tr>
                        <th colspan="2">
                            <p class="lang-vi">Sản phẩm</p>
                            <p class="lang-en" style="display: none;">Product</p>
                        </th>
                        <th>
                            <p class="lang-vi">Số lượng</p>
                            <p class="lang-en" style="display: none;">Quantity</p>
                        </th>
                        <th>
                            <p class="lang-vi">Đơn giá</p>
                            <p class="lang-en" style="display: none;">Price</p>
                        </th>
                        <th colspan="2">
                            <p class="lang-vi">Thành tiền</p>
                            <p class="lang-en" style="display: none;">Subtotal</p>
                        </th>
                    </tr>
                </thead>
                <!-- Ở trang sản phẩm khi ấn mua ngay thì sản phẩm sẽ hiện ở trong tbody  -->
                <tbody></tbody>
                <!-- Phần tổng tiền và thanh toán  -->
                <tfoot>
                    <tr>
                        <td colspan="4" class="text-end">
                            <h2>
                                <p class="lang-vi">TỔNG =</p>
                                <p class="lang-en" style="display: none;">TOTAL =</p>
                            </h2>
                        </td>
                        <td colspan="2">
                            <p id="bill_total"></p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="6">
                            <!-- Nút thanh toán và modal điền thông tin  -->
                            <!-- Dùng bootstrap class="d-flex justify-content-center" để căn giữa  -->
                            <div class="btn-purchase d-flex justify-content-center">
                                <button type="button" id="checkout-button" class="btn btn-dark lang-vi">
                                    <i class="fa-solid fa-cart-shopping m-2"></i>THANH TOÁN
                                </button>
                                <button type="button" id="checkout-button" class="btn btn-dark lang-en" style="display:none">
                                    <i class="fa-solid fa-cart-shopping m-2"></i>PURCHASE
                                </button>
                            </div>
                            <!-- modal điền thông tin  -->
                            <div id="modal" class="modal">
                                <div class="modal-content">
                                    <span class="close">&times;</span>
                                    <!-- function checkCustomerInfo(this) kiểm tra tính hợp lệ người dùng nhập  -->
                                    <!-- Form nhận hàng  -->
                                    <form id="customer-info-form" onsubmit="return checkCustomerInfo(this)">
                                        <!-- Điền tên  -->
                                        <label for="name">Tên:</label><br>
                                        <input type="text" id="name" name="name" required><br>
                                        <!-- Điền Email  -->
                                        <label for="email">Email:</label><br>
                                        <input type="email" id="email" name="email"><br>
                                        <!-- Điền số điện thoại  -->
                                        <label for="phone">Số điện thoại:</label><br>
                                        <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required><br>
                                        <!-- Điền địa chỉ nhận hàng  -->
                                        <label for="address">Địa chỉ nhận hàng:</label><br>
                                        <input type="text" id="address" name="address" required><br>
                                        <!-- Nút submit để gửi đi thông tin  -->
                                        <input type="submit" value="Submit">
                                    </form>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </article>
    </main>

    <footer>
        <!-- Phần cuối cùng của footer -->
        <div class="footer_end">
            <!-- Liên kết đến trang Chính Sách và Điều Khoản -->
            <a class="lang-vi" href="./policy.html">Chính Sách và Điều Khoản</a>
            <!-- Liên kết đến trang Terms and Conditions (ẩn) -->
            <a class="lang-en" style="display: none;" href="./policy.html">Terms and Conditions</a>
            <!-- Các biểu tượng mạng xã hội -->
            <a href="https://www.facebook.com/" class="social-icon" target="_blank">
                <i class="fa-brands fa-meta"></i>
            </a>
            <a href="https://www.twitter.com/" class="social-icon" target="_blank">
                <i class="fa-brands fa-x-twitter"></i>
            </a>
            <a href="https://github.com/" class="social-icon" target="_blank">
                <i class="fa-brands fa-github"></i>
            </a>
        </div>
        <!-- Thông điệp bản quyền -->
        <p class="lang-vi">Bản quyền trang web thuộc về <i>&copy;Trung Dong Mobile</i></p>
        <!-- Thông điệp bản quyền (ẩn) -->
        <p class="lang-en" style="display: none;">Copyright of this website belongs to <i>&copy;Trung Dong Mobile</i></p>
        <!-- Nút "Quay về đầu trang" -->
        <a href="#search" class="gotop">
            <i class="fa-solid fa-chevron-up"></i>
        </a>
    </footer>

    <script>
        var modal = document.getElementById("modal");
        var btn = document.getElementById("checkout-button");
        var span = document.getElementsByClassName("close")[0];

        btn.onclick = function() {
            modal.style.display = "block";
        }

        span.onclick = function() {
            modal.style.display = "none";
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        function checkCustomerInfo(event) {
            event.preventDefault();
            var name = document.getElementById("name").value;
            var email = document.getElementById("email").value;
            var phone = document.getElementById("phone").value;
            var address = document.getElementById("address").value;
            // Kiểm tra tên không được để trống
            if (!name) {
                alert("Tên không được để trống.");
                return;
            }
            // Kiểm tra email có đúng định dạng ***@gmail.com
            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (email && !emailPattern.test(email)) {
                alert("Email không hợp lệ. Vui lòng nhập email đúng định dạng ***@gmail.com.");
                return;
            }
            // Kiểm tra số điện thoại có 10 ký tự
            var cleanedPhone = phone.replace(/\D/g, "");
            if (cleanedPhone.length !== 10) {
                alert("Số điện thoại không hợp lệ. Vui lòng nhập 10 số.");
                return;
            }
            // Kiểm tra địa chỉ không được để trống
            if (!address) {
                alert("Địa chỉ không được để trống.");
                return;
            }
            // Nếu tất cả thông tin đều hợp lệ, chuyển hướng người dùng đến trang thanh toán
            alert("Thông tin hợp lệ. Đặt hàng thành công!.");
        }
        document.getElementById('customer-info-form').addEventListener('submit', checkCustomerInfo);
        // product
        var itemList = {
            "ip01": {
                "name": "IPhone 15",
                "price": 19490000,
                "photo": "./img/product/Iphone/iphone-15-pink.png"
            },
            "ip02": {
                "name": "IPhone 15 Plus",
                "price": 2299000,
                "photo": "./img/product/Iphone/iphone-15-plus-blue.png"
            },
            "ip03": {
                "name": "IPhone Pro",
                "price": 25490000,
                "photo": "./img/product/Iphone/iphone-15-pro-finish-select.png"
            },
            "ip04": {
                "name": "IPhone Pro Max",
                "price": 29490000,
                "photo": "./img/product/Iphone/iphone-15-pro-finish-select.png"
            },
            "ip05": {
                "name": "IPhone 11",
                "price": 8990000,
                "photo": "./img/product/Iphone/iphone-11.jpg"
            },
            "ip06": {
                "name": "IPhone 13",
                "price": 13990000,
                "photo": "./img/product/Iphone/iphone-13.jpg"
            },
            "ip07": {
                "name": "IPhone 14",
                "price": 20090000,
                "photo": "./img/product/Iphone/iphone-13.jpg"
            },
            "ip08": {
                "name": "IPhone 12",
                "price": 14990000,
                "photo": "./img/product/Iphone/iphone-14.jpeg"
            },

            "ss01": {
                "name": "Samsung Galaxy Z Fold 5",
                "price": 29990000,
                "photo": "./img/product/sumSung/samsung-galaxy-a04.jpg"
            },
            "ss02": {
                "name": "Samsung Galaxy A15 5G",
                "price": 5490000,
                "photo": "./img/product/sumSung/samsung-galaxy-a15-5g-xanh.jpg"
            },
            "ss03": {
                "name": "Samsung Galaxy A25 5G",
                "price": 6190000,
                "photo": "./img/product/sumSung/samsung-galaxy-a25-den.jpg"
            },
            "ss04": {
                "name": "Samsung Galaxy S24 Ultra 5G",
                "price": 31790000,
                "photo": "./img/product/sumSung/samsung-galaxy-s24-ultra-grey.jpg"
            },
            "ss05": {
                "name": "Samsung Galaxy A34 5G 512GB",
                "price": 8290000,
                "photo": "./img/product/sumSung/samsung-galaxy-a34.jpg"
            },
            "ss06": {
                "name": "Samsung Galaxy M34 5G 128GB",
                "price": 6290000,
                "photo": "./img/product/sumSung/samsung-galaxy-m34-xanh-ngoc.jpg"
            },
            "ss07": {
                "name": "Samsung Galaxy M54 5G 256GB",
                "price": 8490000,
                "photo": "./img/product/sumSung/samsung-galaxy-m54-bac.jpg"
            },
            "ss08": {
                "name": "Samsung Galaxy S23 Ultra 5G",
                "price": 21090000,
                "photo": "./img/product/sumSung/samsung-galaxy-s23-ultra.jpg"
            },
        }

        function addCart(code) {
            var number = parseInt(document.getElementById(code).value);
            var name = itemList[code].name;
            if (number == 0)
                return;
            if (typeof localStorage[code] === "undefined") {
                window.localStorage.setItem(code, number);
            } else {
                var current = parseInt(window.localStorage.getItem(code));
                if (current + number > 99) {
                    window.localStorage.setItem(code, 99);
                    alert("Mỗi mặt hàng chỉ có thể đặt 100 sản phẩm cho mỗi đơn hàng.");
                    return;
                } else
                    window.localStorage.setItem(code, current + number);
            }
            alert("Đã thêm" + number + " sản phẩm " + name + " vào giỏ hàng. Số lượng sản phẩm " + name + " đã đặt là " + parseInt(window.localStorage.getItem(code)) + ".");
        }

        function openCart() {
            window.location.href = "cart.html";
        }


        function showCart() {
            var formatter = new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            });
            var container = document.getElementById("cartDetail").getElementsByTagName('tbody')[0];
            container.innerHTML = "";

            var sum = 0;
            var total = 0;
            for (var i = 0; i < window.localStorage.length; i++) {
                if (typeof itemList[localStorage.key(i)] === "undefined")
                    continue;
                var tr = document.createElement("tr");
                var photoCell = document.createElement("td");
                var nameCell = document.createElement("td");
                var priceCell = document.createElement("td");
                var numberCell = document.createElement("td");
                var sumCell = document.createElement("td");
                var removeCell = document.createElement("td");
                var removeLink = document.createElement("a");
                var item = itemList[localStorage.key(i)];
                var number = localStorage.getItem(localStorage.key(i));

                photoCell.style.textAlign = "center";
                photoCell.innerHTML = "<img src='" + item.photo + "' class='round-figure 'width='100px'/>";

                nameCell.innerHTML = item.name;

                priceCell.innerHTML = formatter.format(item.price);
                priceCell.style.textAlign = "left";

                numberCell.innerHTML = number;
                numberCell.style.textAlign = "center";

                sum = number * item.price;
                sumCell.innerHTML = formatter.format(sum);
                sumCell.style.textAlign = "left";

                removeLink.innerHTML = "<i class='fa fa-trash icon-red'></i>";

                removeLink.setAttribute("href", "#");
                removeLink.setAttribute("data-code", localStorage.key(i));
                removeLink.onclick = function() {
                    removeCart(this.dataset.code);
                };

                removeCell.style.textAlign = "center";
                removeCell.appendChild(removeLink);

                tr.appendChild(photoCell);
                tr.appendChild(nameCell);
                tr.appendChild(numberCell);
                tr.appendChild(priceCell);
                tr.appendChild(sumCell);
                tr.appendChild(removeCell);

                container.appendChild(tr);
                total += sum;
            }
            document.getElementById("bill_total").innerHTML = formatter.format(total);

        }


        function removeCart(code) {
            if (typeof window.localStorage[code] !== "undefined") {
                window.localStorage.removeItem(code);
                document.getElementById("cartDetail").getElementsByTagName('tbody')[0].innerHTML = "";
                showCart();
            }
        }

        window.onstorage = () => {
            showCart();
        };
    </script>
    <script src="script.js" defer></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
</body>

</html>